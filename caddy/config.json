{
  "http":{
    "servers":{
      "srv0":{
        "listen":[
          ":443"
        ],
        "routes":[
          {
            "handle":[
              {
                "handler":"subroute",
                "routes":[
                  {
                    "handle":[
                      {
                        "body":"Hello, world!",
                        "handler":"static_response"
                      }
                    ],
                    "match":[
                      {
                        "path":[
                          "/"
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "match":[
              {
                "host":[
                  "test.localhost"
                ]
              }
            ],
            "terminal":true
          },
          {
            "handle":[
              {
                "handler":"subroute",
                "routes":[
                  {
                    "handle":[
                      {
                        "handler":"reverse_proxy",
                        "upstreams":[
                          {
                            "dial":"localhost:81"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "match":[
              {
                "host":[
                  "dev.localhost"
                ]
              }
            ],
            "terminal":true
          }
        ]
      },
      "srv1":{
        "listen":[
          ":80"
        ],
        "routes":[
          {
            "handle":[
              {
                "handler":"subroute",
                "routes":[
                  {
                    "handle":[
                      {
                        "body":"Hello, world!",
                        "handler":"static_response"
                      }
                    ],
                    "match":[
                      {
                        "path":[
                          "/"
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "match":[
              {
                "host":[
                  "test.localhost"
                ]
              }
            ],
            "terminal":true
          },
          {
            "handle":[
              {
                "handler":"subroute",
                "routes":[
                  {
                    "handle":[
                      {
                        "handler":"reverse_proxy",
                        "upstreams":[
                          {
                            "dial":"localhost:81"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "match":[
              {
                "host":[
                  "dev.localhost"
                ]
              }
            ],
            "terminal":true
          }
        ]
      },
      "srv2":{
        "listen":[
          ":81"
        ],
        "logs":{

        },
        "routes":[
          {
            "handle":[
              {
                "handler":"subroute",
                "routes":[
                  {
                    "handle":[
                      {
                        "handler":"rewrite",
                        "strip_path_prefix":"/api"
                      }
                    ]
                  },
                  {
                    "group":"group0",
                    "handle":[
                      {
                        "handler":"rewrite",
                        "uri":"{http.request.uri.path}"
                      }
                    ],
                    "match":[
                      {
                        "path":[
                          "/api/*"
                        ]
                      }
                    ]
                  },
                  {
                    "handle":[
                      {
                        "handler":"reverse_proxy",
                        "headers":{
                          "request":{
                            "set":{
                              "Host":[
                                "{upstream_hostport}"
                              ],
                              "X-Forwarded-Host":[
                                "{http.request.host}"
                              ]
                            }
                          }
                        },
                        "upstreams":[
                          {
                            "dial":"localhost:2019"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "match":[
              {
                "path":[
                  "/api/*"
                ]
              }
            ]
          },
          {
            "handle":[
              {
                "handler":"reverse_proxy",
                "upstreams":[
                  {
                    "dial":"192.168.123.110:8080"
                  }
                ]
              }
            ]
          }
        ]
      }
    }
  }
}